---
import Base from '../../layouts/Base.astro';

const allPosts = await Astro.glob('./**/*.mdx');

const articles = allPosts.filter(post => post.frontmatter.type === 'article');
const weeklyReviews = allPosts.filter(post => post.frontmatter.type === 'weekly-review');
const tils = allPosts.filter(post => post.frontmatter.type === 'til');

// Sort by date descending
const sortByDate = (a: any, b: any) =>
    new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime();

articles.sort(sortByDate);
weeklyReviews.sort(sortByDate);
tils.sort(sortByDate);
---

<Base title="Blog - Dewang Gogte">
    <header>
        <h1><a href="/" class="home-link">Dewang Gogte</a></h1>
    </header>

    {weeklyReviews.length > 0 && (
        <section class="blog-section">
            <h2>Weekly Reviews</h2>
            <ul class="post-list">
                {weeklyReviews.map(post => (
                    <li>
                        <a href={post.url}>{post.frontmatter.title}</a>
                        <span class="post-date">{post.frontmatter.date}</span>
                    </li>
                ))}
            </ul>
        </section>
    )}

    {articles.length > 0 && (
        <section class="blog-section">
            <h2>Articles</h2>
            <ul class="post-list">
                {articles.map(post => (
                    <li>
                        <a href={post.url}>{post.frontmatter.title}</a>
                        <span class="post-date">{post.frontmatter.date}</span>
                    </li>
                ))}
            </ul>
        </section>
    )}

    {tils.length > 0 && (
        <section class="blog-section">
            <h2>T.I.L.</h2>
            <ul class="post-list">
                {tils.map(post => (
                    <li>
                        <a href={post.url}>{post.frontmatter.title}</a>
                        <span class="post-date">{post.frontmatter.date}</span>
                    </li>
                ))}
            </ul>
        </section>
    )}

    {allPosts.length === 0 && (
        <p class="empty-state">No posts yet. Check back soon!</p>
    )}

    <section class="links-section">
        <div class="footer-row">
            <a href="/Dewang_2026.pdf" target="_blank" rel="noopener noreferrer">Resume</a>
            <a href="/">Home</a>
            <span class="elsewhere">
                <span class="elsewhere-label">Elsewhere:</span>
                <a href="mailto:dewanggogte@gmail.com" class="icon-link" aria-label="Email"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg></a>
                <a href="https://linkedin.com/in/dewanggogte" target="_blank" rel="noopener noreferrer" class="icon-link" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
                <a href="https://instagram.com/dewangraphy" target="_blank" rel="noopener noreferrer" class="icon-link" aria-label="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/></svg></a>
            </span>
        </div>
    </section>
</Base>

<style>
    .home-link {
        color: var(--text);
    }

    .home-link:hover {
        color: var(--accent);
        text-decoration: none;
    }

    .page-title {
        color: var(--text-light);
        font-size: 1rem;
        margin-top: 0.25rem;
    }

    .blog-section {
        margin-top: 2.5rem;
    }

    .blog-section h2 {
        font-size: 0.85rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-light);
        margin-bottom: 1rem;
    }

    .post-list {
        list-style: none;
    }

    .post-list li {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border);
    }

    .post-list li:last-child {
        border-bottom: none;
    }

    .post-list a {
        color: var(--text);
    }

    .post-list a:hover {
        color: var(--accent);
        text-decoration: none;
    }

    .post-date {
        font-size: 0.85rem;
        color: var(--text-light);
    }

    .empty-state {
        color: var(--text-light);
        margin-top: 2rem;
    }

    .links-section {
        padding-top: 1.5rem;
        margin-top: 2rem;
        border-top: 1px solid var(--border);
    }

    .footer-row {
        display: flex;
        flex-wrap: wrap;
        align-items: baseline;
        justify-content: center;
        gap: 2rem;
    }

    .footer-row > a {
        font-size: 0.85rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-light);
    }

    .footer-row > a:hover {
        color: var(--accent);
        text-decoration: none;
    }


    .elsewhere {
        display: inline-flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.5rem;
    }

    .elsewhere-label {
        font-size: 0.85rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-light);
    }

    .elsewhere a {
        font-size: 0.7rem;
        color: var(--text-light);
    }

    .elsewhere a:hover {
        color: var(--accent);
        text-decoration: none;
    }

    .elsewhere a::before {
        content: 'â€¢';
        margin-right: 0.5rem;
        color: var(--text-light);
    }

    .elsewhere a.icon-link {
        display: inline-flex;
        align-items: center;
        margin-left: 0.5rem;
    }

    .elsewhere a.icon-link::before {
        content: none;
    }

    .elsewhere a.icon-link svg {
        width: 16px;
        height: 16px;
    }
</style>
